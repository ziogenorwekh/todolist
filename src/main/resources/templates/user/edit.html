<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>회원정보 수정</title>
  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    /* 배경 & 카드 */
    body {
      min-height: 100vh;
      background: radial-gradient(1200px 600px at 10% 10%, #f0f7ff, transparent),
      radial-gradient(1200px 600px at 90% 20%, #fff5f7, transparent),
      linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%);
    }
    .page-wrap { display:flex; align-items:center; justify-content:center; padding:48px 16px;}
    .profile-card {
      width:100%; max-width:820px;
      border: none; border-radius: 1.25rem;
      box-shadow: 0 10px 30px rgba(16,24,40,.08), 0 6px 12px rgba(16,24,40,.06);
      overflow:hidden; background: #fff;
    }
    .card-header {
      background: linear-gradient(135deg,#4f46e5,#7c3aed);
      color:#fff; padding: 22px 24px;
    }
    .card-header .title {
      display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px;
    }
    .sub { opacity:.9; font-weight:500; font-size:.95rem; }

    .avatar {
      width:96px; height:96px; border-radius:50%;
      object-fit:cover; border:3px solid rgba(255,255,255,.9);
      box-shadow: 0 6px 18px rgba(0,0,0,.12);
    }
    .avatar-ring {
      position:relative; display:inline-block;
    }
    .avatar-ring::after{
      content:""; position:absolute; inset:-6px; border-radius:50%;
      border:2px dashed rgba(124,58,237,.25);
    }

    /* 플로팅 라벨 보완 */
    .form-floating > label { color:#6b7280; }
    .form-control:focus {
      box-shadow: 0 0 0 .25rem rgba(79,70,229,.15);
      border-color:#635bff;
    }
    .help-text { font-size:.85rem; color:#64748b; }

    .section-title {
      font-weight:700; color:#0f172a; letter-spacing:.1px; margin-bottom:.75rem;
    }
    hr.soft { border:0; height:1px; background:linear-gradient(to right, transparent, #e5e7eb, transparent); margin:1.25rem 0; }

    /* 버튼 */
    .btn-primary {
      background: linear-gradient(135deg,#4f46e5,#7c3aed);
      border: none;
    }
    .btn-primary:hover { filter: brightness(.95); }
  </style>
</head>
<body>
<div class="page-wrap">
  <div class="profile-card card">
    <div class="card-header">
      <div class="d-flex align-items-center justify-content-between">
        <div class="title">
          <i class="bi bi-person-gear fs-4"></i>
          <span>회원정보 수정</span>
        </div>
        <div class="d-none d-md-flex align-items-center gap-3">
          <span class="sub"><i class="bi bi-shield-lock"></i> 보안 보호됨</span>
        </div>
      </div>
    </div>

    <div class="card-body p-4 p-md-5">
      <form th:action="@{/users/me/edit}" th:object="${form}" method="post" class="needs-validation" novalidate>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <!-- 상단: 아바타 미리보기 + 기본 정보 -->
        <div class="row g-4">
          <div class="col-12 col-md-4 text-center">
            <div class="avatar-ring mx-auto">
              <img id="avatarPreview"
                   class="avatar"
                   th:src="${form.profileImageUrl} ?: @{/images/default-avatar.png}"
                   alt="프로필 이미지">
            </div>
            <div class="help-text mt-3"><i class="bi bi-lightbulb"></i> 이미지 URL을 입력하면 미리보기가 갱신돼요.</div>
          </div>

          <div class="col-12 col-md-8">
            <div class="section-title">기본 정보</div>

            <div class="form-floating mb-3">
              <input type="text" th:field="*{displayName}" class="form-control" id="displayName" placeholder="예: 하은">
              <label for="displayName"><i class="bi bi-person"></i> 표시 이름</label>
              <div class="text-danger small mt-1" th:if="${#fields.hasErrors('displayName')}" th:errors="*{displayName}"></div>
            </div>

            <div class="form-floating mb-3">
              <input type="email" th:field="*{email}" class="form-control bg-light" id="email" readonly tabindex="-1" style="pointer-events:none;">
              <label for="email"><i class="bi bi-envelope"></i> 이메일</label>
              <div class="text-danger small mt-1" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
            </div>

            <div class="input-group mb-3">
              <span class="input-group-text"><i class="bi bi-image"></i></span>
              <input type="text" th:field="*{profileImageUrl}" class="form-control" id="profileImageUrl" placeholder="https://...">
            </div>
          </div>
        </div>

        <hr class="soft">

        <!-- 비밀번호 변경 -->
        <div class="row g-3">
          <div class="col-12">
            <div class="section-title">비밀번호 변경 <span class="text-muted fw-normal fs-6">(선택)</span></div>
          </div>

          <div class="col-12 col-md-6">
            <div class="form-floating">
              <input type="password" th:field="*{newPassword}" class="form-control" id="newPassword" placeholder="새 비밀번호">
              <label for="newPassword"><i class="bi bi-key"></i> 새 비밀번호</label>
            </div>
          </div>

          <div class="col-12 col-md-6">
            <div class="form-floating">
              <input type="password" th:field="*{newPasswordConfirm}" class="form-control" id="newPasswordConfirm" placeholder="새 비밀번호 확인">
              <label for="newPasswordConfirm"><i class="bi bi-shield-check"></i> 새 비밀번호 확인</label>
            </div>
            <div class="text-danger small mt-1" th:if="${#fields.hasErrors('newPasswordConfirm')}" th:errors="*{newPasswordConfirm}"></div>
          </div>
        </div>

        <!-- 액션 -->
        <div class="d-flex gap-2 justify-content-end mt-4">
          <a th:href="@{/}" class="btn btn-light border"><i class="bi bi-arrow-left"></i> 돌아가기</a>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i> 저장
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- 아바타 미리보기 업데이트 -->
<script>
  (function () {
    const input = document.getElementById('profileImageUrl');
    const preview = document.getElementById('avatarPreview');
    if (input && preview) {
      const update = () => {
        const url = input.value?.trim();
        if (url && /^https?:\/\//i.test(url)) preview.src = url;
      };
      input.addEventListener('input', update);
      input.addEventListener('change', update);
    }
  })();
</script>
</body>
</html>



<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org" lang="ko">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>회원정보 수정</title>-->
<!--</head>-->
<!--<body>-->
<!--<h2>회원정보 수정</h2>-->

<!--<form th:action="@{/users/me/edit}" th:object="${form}" method="post">-->
<!--  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->

<!--  <div>-->
<!--    <label>표시 이름</label>-->
<!--    <input type="text" th:field="*{displayName}" placeholder="예: 하은">-->
<!--    <div th:if="${#fields.hasErrors('displayName')}" th:errors="*{displayName}">표시이름 에러</div>-->
<!--  </div>-->

<!--  <div>-->
<!--    <label>이메일</label>-->
<!--    <input type="email" th:field="*{email}" placeholder="you@example.com">-->
<!--    <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}">이메일 에러</div>-->
<!--  </div>-->

<!--  <div>-->
<!--    <label>프로필 이미지 URL</label>-->
<!--    <input type="text" th:field="*{profileImageUrl}" placeholder="https://...">-->
<!--  </div>-->

<!--  <hr>-->

<!--  <div>-->
<!--    <label>새 비밀번호 (선택)</label>-->
<!--    <input type="password" th:field="*{newPassword}">-->
<!--  </div>-->
<!--  <div>-->
<!--    <label>새 비밀번호 확인</label>-->
<!--    <input type="password" th:field="*{newPasswordConfirm}">-->
<!--    <div th:if="${#fields.hasErrors('newPasswordConfirm')}" th:errors="*{newPasswordConfirm}">비밀번호 확인 에러</div>-->
<!--  </div>-->

<!--  <button type="submit">저장</button>-->
<!--</form>-->

<!--</body>-->
<!--</html>-->